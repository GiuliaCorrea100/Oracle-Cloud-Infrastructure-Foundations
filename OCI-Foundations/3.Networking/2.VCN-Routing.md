## Overview

In OCI networking, **routing** determines how traffic moves **out of and between** your Virtual Cloud Networks (VCNs).

Routing in OCI is managed using **Route Tables**, which define **where traffic should go** based on its destination.

---

## What Is a Route Table?

A **Route Table** is a set of **Route Rules** that control the flow of network traffic.

Each **route rule** contains:

- **Destination CIDR block:** Defines the IP range of the traffic destination.
- **Route target:** The **next hop** for that traffic (e.g., Internet Gateway, NAT Gateway, DRG).

Example of a route rule:

```sql
Destination: 0.0.0.0/0 → Target: NAT Gateway
Destination: 172.16.0.0/16 → Target: Dynamic Routing Gateway
```

## Local Routing (Automatic Inside VCN)

Traffic **within the same VCN subnet or between subnets** is automatically routed by the **VCN local routing system** — you don’t need to add any explicit entries for that.

So:

- Public ↔ Private subnet traffic = automatic, **no route entry needed**.
- Outbound or cross-network traffic = **requires route table entries**.

---

## Example: Private Subnet Routing

Imagine a **private subnet** hosting a database instance.

Two main routing scenarios occur:

### a) Outbound Internet Access via NAT Gateway

- **Destination:** `0.0.0.0/0`
- **Target:** **NAT Gateway**
- Purpose: Database downloads patches or updates from the Internet (outbound only).

### b) On-Premises Communication via DRG

- **Destination:** `172.16.0.0/16` (on-prem network)
- **Target:** **Dynamic Routing Gateway (DRG)**
- Purpose: Database resolves DNS or connects to local data center.

---

## Route Table Logic – Longest Prefix Match

When multiple routes could apply, OCI uses **Longest Prefix Match**:

- The route with the most specific CIDR (largest subnet mask) takes priority.

Example:

```sql
172.16.0.0/16 → DRG
0.0.0.0/0     → NAT Gateway
```

Traffic for `172.16.x.x` → goes through **DRG** (more specific).

Everything else → goes through **NAT Gateway**.

---

## Peering Between VCNs

### a) Local Peering

- Used for **VCNs in the same OCI region**.
- Implemented via a **Local Peering Gateway (LPG)**.
- Enables private communication **without using the Internet**.

### b) Remote Peering

- Used for **VCNs in different OCI regions**.
- Uses **Dynamic Routing Gateways (DRG)** for communication.
- Creates private, cross-region network connectivity.

---

## DRG v2 – Scalable Connectivity

In large environments with **many VCNs** (10, 100, or 300+), managing multiple local peerings becomes complex.

OCI introduced **Dynamic Routing Gateway v2 (DRG v2)** to simplify this:

- Supports **hub-and-spoke topology** — no more individual point-to-point links.
- Allows up to **300 VCNs** connected to a **single DRG**.
- Can connect multiple DRGs through **remote peering** for even larger setups.

**Benefit:** Simplifies management and improves scalability for multi-VCN architectures.

---

| Concept | Description |
| --- | --- |
| **Route Table** | Defines how traffic exits a subnet or VCN |
| **Route Rule** | Maps a destination CIDR to a next-hop target |
| **Automatic Local Routing** | Handled internally by VCN for intra-VCN traffic |
| **Longest Prefix Match** | Most specific route takes priority |
| **Local Peering Gateway (LPG)** | Enables communication between VCNs in the same region |
| **Remote Peering via DRG** | Connects VCNs in different regions |
| **DRG v2** | Centralized, scalable routing for up to 300 VCNs |